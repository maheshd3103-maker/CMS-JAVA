{"ast":null,"code":"import React,{useState,useEffect}from'react';import{complaintAPI}from'../services/api';import Sidebar from'../components/Sidebar';import'./Dashboard.css';import'./Forms.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ComplaintHistory=()=>{const[complaints,setComplaints]=useState([]);const[sortedComplaints,setSortedComplaints]=useState([]);const[sortOrder,setSortOrder]=useState('desc');const[loading,setLoading]=useState(true);useEffect(()=>{const fetchComplaints=async()=>{try{const response=await complaintAPI.getComplaintHistory();setComplaints(response.data);setSortedComplaints(response.data.sort((a,b)=>new Date(b.issueDate)-new Date(a.issueDate)));}catch(error){console.error('Error fetching complaints:',error);}finally{setLoading(false);}};fetchComplaints();},[]);const handleSort=()=>{const newOrder=sortOrder==='desc'?'asc':'desc';setSortOrder(newOrder);const sorted=[...complaints].sort((a,b)=>{return newOrder==='desc'?new Date(b.issueDate)-new Date(a.issueDate):new Date(a.issueDate)-new Date(b.issueDate);});setSortedComplaints(sorted);};const getStatusClass=status=>{switch(status.toLowerCase()){case'pending':return'pending';case'in progress':return'in-progress';case'resolved':return'resolved';default:return'';}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-layout\",children:[/*#__PURE__*/_jsx(Sidebar,{userRole:\"MANAGER\",activeItem:\"history\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Complaint History\"}),/*#__PURE__*/_jsx(\"p\",{children:\"View all resolved complaints\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-secondary\",onClick:handleSort,children:[\"Sort by Date (\",sortOrder==='desc'?'Newest First':'Oldest First',\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Tracking ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Issue Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Resolved Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:sortedComplaints.length>0?sortedComplaints.map(complaint=>{var _complaint$user;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"tracking-id\",children:complaint.trackingId}),/*#__PURE__*/_jsx(\"td\",{children:(_complaint$user=complaint.user)===null||_complaint$user===void 0?void 0:_complaint$user.username}),/*#__PURE__*/_jsx(\"td\",{children:complaint.complaintType}),/*#__PURE__*/_jsx(\"td\",{children:complaint.complaintDescription}),/*#__PURE__*/_jsx(\"td\",{children:complaint.issueDate}),/*#__PURE__*/_jsx(\"td\",{children:complaint.resolvedDate||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"status \".concat(getStatusClass(complaint.status)),children:complaint.status})})]},complaint.complaintId);}):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{colSpan:\"7\",className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"No complaint history\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No complaints have been processed yet.\"})]})})})]})})]})]});};export default ComplaintHistory;","map":{"version":3,"names":["React","useState","useEffect","complaintAPI","Sidebar","jsx","_jsx","jsxs","_jsxs","ComplaintHistory","complaints","setComplaints","sortedComplaints","setSortedComplaints","sortOrder","setSortOrder","loading","setLoading","fetchComplaints","response","getComplaintHistory","data","sort","a","b","Date","issueDate","error","console","handleSort","newOrder","sorted","getStatusClass","status","toLowerCase","className","children","userRole","activeItem","onClick","length","map","complaint","_complaint$user","trackingId","user","username","complaintType","complaintDescription","resolvedDate","concat","complaintId","colSpan"],"sources":["C:/Users/2382082/Downloads/CMS/frontend/src/pages/ComplaintHistory.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { complaintAPI } from '../services/api';\nimport Sidebar from '../components/Sidebar';\nimport './Dashboard.css';\nimport './Forms.css';\n\nconst ComplaintHistory = () => {\n  const [complaints, setComplaints] = useState([]);\n  const [sortedComplaints, setSortedComplaints] = useState([]);\n  const [sortOrder, setSortOrder] = useState('desc');\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchComplaints = async () => {\n      try {\n        const response = await complaintAPI.getComplaintHistory();\n        setComplaints(response.data);\n        setSortedComplaints(response.data.sort((a, b) => new Date(b.issueDate) - new Date(a.issueDate)));\n      } catch (error) {\n        console.error('Error fetching complaints:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchComplaints();\n  }, []);\n\n  const handleSort = () => {\n    const newOrder = sortOrder === 'desc' ? 'asc' : 'desc';\n    setSortOrder(newOrder);\n    const sorted = [...complaints].sort((a, b) => {\n      return newOrder === 'desc' \n        ? new Date(b.issueDate) - new Date(a.issueDate)\n        : new Date(a.issueDate) - new Date(b.issueDate);\n    });\n    setSortedComplaints(sorted);\n  };\n\n  const getStatusClass = (status) => {\n    switch (status.toLowerCase()) {\n      case 'pending': return 'pending';\n      case 'in progress': return 'in-progress';\n      case 'resolved': return 'resolved';\n      default: return '';\n    }\n  };\n\n  if (loading) {\n    return <div className=\"loading\">Loading...</div>;\n  }\n\n  return (\n    <div className=\"dashboard-layout\">\n      <Sidebar userRole=\"MANAGER\" activeItem=\"history\" />\n      <div className=\"main-content\">\n        <div className=\"header\">\n          <h1>Complaint History</h1>\n          <p>View all resolved complaints</p>\n          <button \n            className=\"btn btn-secondary\"\n            onClick={handleSort}\n          >\n            Sort by Date ({sortOrder === 'desc' ? 'Newest First' : 'Oldest First'})\n          </button>\n        </div>\n        \n        <div className=\"table-container\">\n          <table className=\"table\">\n            <thead>\n              <tr>\n                <th>Tracking ID</th>\n                <th>Customer</th>\n                <th>Type</th>\n                <th>Description</th>\n                <th>Issue Date</th>\n                <th>Resolved Date</th>\n                <th>Status</th>\n              </tr>\n            </thead>\n            <tbody>\n              {sortedComplaints.length > 0 ? (\n                sortedComplaints.map((complaint) => (\n                  <tr key={complaint.complaintId}>\n                    <td className=\"tracking-id\">{complaint.trackingId}</td>\n                    <td>{complaint.user?.username}</td>\n                    <td>{complaint.complaintType}</td>\n                    <td>{complaint.complaintDescription}</td>\n                    <td>{complaint.issueDate}</td>\n                    <td>{complaint.resolvedDate || 'N/A'}</td>\n                    <td>\n                      <span className={`status ${getStatusClass(complaint.status)}`}>\n                        {complaint.status}\n                      </span>\n                    </td>\n                  </tr>\n                ))\n              ) : (\n                <tr>\n                  <td colSpan=\"7\" className=\"empty-state\">\n                    <h3>No complaint history</h3>\n                    <p>No complaints have been processed yet.</p>\n                  </td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ComplaintHistory;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}